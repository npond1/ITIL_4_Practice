<!-- File: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Practice Quiz</title>
  <!-- Inline dark-mode and responsive CSS -->
  <style>
    :root {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --primary-color: #BB86FC;
      --button-bg: #1F1B24;
      --button-hover-bg: #2A242E;
      --correct-color: #2e7d32;
      --incorrect-color: #c62828;
    }
    /* Base styles */
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
    }
    .screen {
      width: 100%;
      max-width: 600px;
      background-color: var(--button-bg);
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.5);
      margin-bottom: 1.5rem;
      text-align: center;
      box-sizing: border-box;
    }
    .hidden { display: none; }
    h1 { font-size: 2rem; margin-bottom: 1rem; }
    h2 { font-size: 1.5rem; margin-bottom: 1rem; }
    label, select, button { margin: 0.5rem 0; }
    select { width: 100%; max-width: 200px; padding: 0.5rem; border-radius: 4px; background: var(--bg-color); color: var(--text-color); border: 1px solid var(--primary-color); }
    button {
      background-color: var(--primary-color);
      border: none;
      color: var(--bg-color);
      padding: 0.75rem 1.5rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      width: 100%;
      max-width: 200px;
    }
    button:hover { background-color: var(--button-hover-bg); }
    .choice-btn {
      display: block;
      width: 80%;
      max-width: 400px;
      margin: 0.5rem auto;
      background-color: var(--button-hover-bg);
      color: var(--text-color);
      border: 1px solid var(--primary-color);
      padding: 0.75rem;
      border-radius: 4px;
      cursor: pointer;
      text-align: left;
      box-sizing: border-box;
      font-size: 1rem;
    }
    .choice-btn:hover { background-color: var(--primary-color); color: var(--bg-color); }
    .choice-btn.selected { background-color: var(--primary-color); color: var(--bg-color); }
    .review-choice { padding: 0.5rem; margin: 0.25rem 0; border-radius: 4px; }
    .review-choice.correct { background-color: var(--correct-color); }
    .review-choice.incorrect { background-color: var(--incorrect-color); }
    ul { list-style: none; padding: 0; margin: 0; }
    li, .review-item { margin: 0.5rem 0; text-align: left; }
    .review-item { border-bottom: 1px solid var(--button-hover-bg); padding-bottom: 1rem; }
    .explanation { font-style: italic; margin-top: 0.5rem; }
    /* Responsive adjustments */
    @media (max-width: 480px) {
      body { padding: 1rem; }
      .screen { padding: 1rem; border-radius: 4px; }
      h1 { font-size: 1.5rem; }
      h2 { font-size: 1.25rem; }
      button, select { max-width: 100%; font-size: 0.9rem; }
      .choice-btn { width: 95%; font-size: 0.9rem; padding: 0.5rem; }
      .explanation { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <!-- Start Screen -->
  <div id="start-screen" class="screen">
    <h1>Practice Quiz</h1>
    <label for="numQuestions">Number of Questions:</label>
    <select id="numQuestions">
      <option>5</option><option>10</option><option>15</option><option>20</option><option>30</option><option>40</option><option>50</option><option>60</option>
    </select>
    <button id="startBtn">Start Quiz</button>
  </div>

  <!-- History Box -->
  <div id="grade-box" class="screen">
    <h2>History</h2>
    <p id="no-grades">No attempts yet.</p>
    <ul id="grade-list" class="hidden"></ul>
  </div>

  <!-- Quiz Container -->
  <div id="quiz-container" class="screen hidden">
    <div id="question-number" style="margin-bottom: 1rem; font-weight: bold;"></div>
    <div id="question-text" style="margin-bottom: 1rem;"></div>
    <div id="choices"></div>
    <button id="backBtn" disabled>Back</button>
    <button id="nextBtn" disabled>Next</button>
    <button id="restartQuizBtn">Start Over</button>
  </div>

  <!-- Result Screen -->
  <div id="result-container" class="screen hidden">
    <h2>Your Score</h2>
    <p id="score-text"></p>
    <button id="restartBtn">Try Again</button>
  </div>

  <!-- Review Screen -->
  <div id="review-container" class="screen hidden">
    <h2>Review</h2>
    <div id="review-list"></div>
  </div>

  <!-- File: questions.js -->
  <script src="questions.js"></script>
  <script>
    // DOM refs
    const startScreen       = document.getElementById('start-screen');
    const gradeBox          = document.getElementById('grade-box');
    const startBtn          = document.getElementById('startBtn');
    const numSelect         = document.getElementById('numQuestions');
    const gradeList         = document.getElementById('grade-list');
    const noGrades          = document.getElementById('no-grades');
    const quizContainer     = document.getElementById('quiz-container');
    const backBtn           = document.getElementById('backBtn');
    const nextBtn           = document.getElementById('nextBtn');
    const restartQuizBtn    = document.getElementById('restartQuizBtn');
    const resultContainer   = document.getElementById('result-container');
    const restartBtn        = document.getElementById('restartBtn');
    const scoreText         = document.getElementById('score-text');
    const reviewContainer   = document.getElementById('review-container');
    const reviewList        = document.getElementById('review-list');
    const questionNumberElem= document.getElementById('question-number');
    const questionTextElem  = document.getElementById('question-text');
    const choicesContainer  = document.getElementById('choices');

    let shuffled = [], lastShuffle = [], currentIndex = 0, score = 0;
    let selectedIdx = null;
    let grades = [];
    let userAnswers = [];

    // Show start and history
    startScreen.classList.remove('hidden');
    gradeBox.classList.remove('hidden');

    // Start quiz
    startBtn.addEventListener('click', () => {
      const num = parseInt(numSelect.value);
      shuffled = questions.map(q => {
        const choices = [...q.choices].sort(() => Math.random() - 0.5);
        return { question: q.question, choices, correct: choices.findIndex(c => c.isCorrect), explanation: q.explanation };
      }).sort(() => Math.random() - 0.5).slice(0, num);
      lastShuffle = JSON.parse(JSON.stringify(shuffled));
      userAnswers = [];
      currentIndex = 0;
      score = 0;
      startScreen.classList.add('hidden');
      gradeBox.classList.add('hidden');
      quizContainer.classList.remove('hidden');
      showQuestion();
    });

    // Next and Back handlers
    nextBtn.addEventListener('click', () => {
      userAnswers.push(selectedIdx);
      if (selectedIdx === shuffled[currentIndex].correct) score++;
      currentIndex++;
      showQuestion();
    });
    backBtn.addEventListener('click', () => {
      // remove last answer
      const prev = userAnswers.pop();
      if (prev === lastShuffle[currentIndex-1].correct) score--;
      currentIndex--;
      showQuestion();
    });

    // Restart quiz/home
    restartQuizBtn.addEventListener('click', () => {
      quizContainer.classList.add('hidden');
      startScreen.classList.remove('hidden');
      gradeBox.classList.remove('hidden');
    });
    restartBtn.addEventListener('click', () => {
      resultContainer.classList.add('hidden');
      reviewContainer.classList.add('hidden');
      startScreen.classList.remove('hidden');
      gradeBox.classList.remove('hidden');
    });

    function showQuestion() {
      reset(); selectedIdx = null;
      if (currentIndex >= shuffled.length) return showResult();
      const q = shuffled[currentIndex];
      questionNumberElem.textContent = `Question ${currentIndex+1} of ${shuffled.length}`;
      questionTextElem.textContent   = q.question;
      q.choices.forEach((c,i) => {
        const btn = document.createElement('button'); btn.textContent = c.text; btn.className = 'choice-btn';
        btn.addEventListener('click', () => {
          const prevSel = choicesContainer.querySelector('.selected'); if(prevSel) prevSel.classList.remove('selected');
          btn.classList.add('selected');
          selectedIdx = i;
          nextBtn.disabled = false;
        });
        choicesContainer.appendChild(btn);
      });
      // Restore selection if going back
      const ua = userAnswers[currentIndex];
      if (ua !== undefined) {
        const btns = choicesContainer.querySelectorAll('.choice-btn');
        btns[ua].classList.add('selected');
        selectedIdx = ua;
        nextBtn.disabled = false;
      }
      // Update buttons state
      backBtn.disabled = currentIndex === 0;
      nextBtn.style.display = currentIndex < shuffled.length-1 ? 'inline-block' : 'inline-block';
      nextBtn.textContent = currentIndex < shuffled.length-1 ? 'Next' : 'Finish';
    }
    function reset() {
      nextBtn.disabled = true;
      choicesContainer.innerHTML = '';
    }

    function showResult() {
      quizContainer.classList.add('hidden');
      resultContainer.classList.remove('hidden');
      const pct = Math.round((score/shuffled.length)*100);
      scoreText.textContent = `You scored ${pct}% (${score} of ${shuffled.length})`;
      grades.push({n:shuffled.length,p:pct});
      updateGrades();
      showReview();
    }

    function updateGrades() {
      noGrades.classList.add('hidden'); gradeList.classList.remove('hidden'); gradeList.innerHTML = '';
      grades.forEach((g,i) => { const li = document.createElement('li'); li.textContent = `Attempt ${i+1} - ${g.n} questions - ${g.p}%`; gradeList.appendChild(li); });
    }

    function showReview() {
      reviewList.innerHTML = '';
      lastShuffle.forEach((qObj, idx) => {
        const div = document.createElement('div'); div.className = 'review-item';
        const pq = document.createElement('p'); pq.textContent = qObj.question; div.appendChild(pq);
        qObj.choices.forEach((c,j) => {
          const d = document.createElement('div'); d.textContent = c.text; d.className = 'review-choice';
          if (j === qObj.correct) d.classList.add('correct');
          const ua = userAnswers[idx]; if (j === ua && j !== qObj.correct) d.classList.add('incorrect');
          div.appendChild(d);
        });
        const ex = document.createElement('div'); ex.textContent = qObj.explanation; ex.className = 'explanation'; div.appendChild(ex);
        reviewList.appendChild(div);
      });
      reviewContainer.classList.remove('hidden');
    }
  </script>
</body>
</html>
